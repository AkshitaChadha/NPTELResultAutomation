<!DOCTYPE html>
<html>
<head>
<title>Login</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="navbar">
    <h3>NPTEL Result System</h3>
</div>

<div class="container" style="max-width:500px; margin-top:60px;">

    <h2 class="page-title" style="text-align:center;">Login</h2>

    <form method="POST" style="margin-top:30px;">

        <input name="email"
               id="email"
               placeholder="Enter Email"
               required
               class="big-input">

        <br>

        <input name="password"
               type="password"
               placeholder="Enter Password"
               required
               class="big-input">

        <br>

        <!-- Role Dropdown -->
        <select name="role"
        id="roleSelect"
        class="big-input">
    <option value="TEACHER">Teacher</option>
</select>

        <br>

        <button class="primary-btn" style="width:100%;">
            Login
        </button>

    </form>

</div>

<script>
document.getElementById("email").addEventListener("blur", function() {

    fetch("/check_roles?email=" + this.value)
    .then(response => response.json())
    .then(data => {

        let select = document.getElementById("roleSelect");
        select.innerHTML = "";

        // ðŸ”´ If real HOD
        if (data.roles.includes("HOD")) {

            let superOption = document.createElement("option");
            superOption.value = "ADMIN";
            superOption.text = "Super Admin";
            select.appendChild(superOption);

            select.value = "ADMIN";
            return;
        }

        // ðŸŸ¢ Always add Teacher
        let teacherOption = document.createElement("option");
        teacherOption.value = "TEACHER";
        teacherOption.text = "Teacher";
        select.appendChild(teacherOption);

        // ðŸŸ¡ If teacher is also admin
        if (data.roles.includes("ADMIN")) {

            let adminOption = document.createElement("option");
            adminOption.value = "ADMIN";
            adminOption.text = "Admin";
            select.appendChild(adminOption);
        }

    });

});
</script>


</body>
</html>
